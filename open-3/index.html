<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>开门</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">
  <style type="text/css">
    html,
    body,
    .btn-box {
      width: 100%;
      height: 100%;
    }

    .btn-box {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .btn-box>span {
      width: 100px;
      height: 100px;
      background-color: green;
      border-radius: 50%;
      text-align: center;
      line-height: 100px;
      font-size: 26px;
    }

    svg {
      width: 100px;
      height: 100px;
      display: none;
    }
  </style>
</head>

<body>
  <div class="btn-box">
    <span class="animated bounceInDown">
      open
    </span>
    <svg version="1.1" id="L1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
      y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
      <circle fill="none" stroke="#008000" stroke-width="6" stroke-miterlimit="15" stroke-dasharray="14.2472,14.2472"
        cx="50" cy="50" r="47" transform="rotate(124.822 50 50)">
        <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="5s" from="0 50 50"
          to="360 50 50" repeatCount="indefinite"></animateTransform>
      </circle>
      <circle fill="none" stroke="#008000" stroke-width="1" stroke-miterlimit="10" stroke-dasharray="10,10" cx="50" cy="50"
        r="39" transform="rotate(-124.822 50 50)">
        <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="5s" from="0 50 50"
          to="-360 50 50" repeatCount="indefinite"></animateTransform>
      </circle>
      <g fill="#008000">
        <rect x="30" y="35" width="5" height="30" transform="translate(0 -2.3272)">
          <animateTransform attributeName="transform" dur="1s" type="translate" values="0 5 ; 0 -5; 0 5"
            repeatCount="indefinite" begin="0.1"></animateTransform>
        </rect>
        <rect x="40" y="35" width="5" height="30" transform="translate(0 -4.3272)">
          <animateTransform attributeName="transform" dur="1s" type="translate" values="0 5 ; 0 -5; 0 5"
            repeatCount="indefinite" begin="0.2"></animateTransform>
        </rect>
        <rect x="50" y="35" width="5" height="30" transform="translate(0 -3.6728)">
          <animateTransform attributeName="transform" dur="1s" type="translate" values="0 5 ; 0 -5; 0 5"
            repeatCount="indefinite" begin="0.3"></animateTransform>
        </rect>
        <rect x="60" y="35" width="5" height="30" transform="translate(0 -1.6728)">
          <animateTransform attributeName="transform" dur="1s" type="translate" values="0 5 ; 0 -5; 0 5"
            repeatCount="indefinite" begin="0.4"></animateTransform>
        </rect>
        <rect x="70" y="35" width="5" height="30" transform="translate(0 0.3272)">
          <animateTransform attributeName="transform" dur="1s" type="translate" values="0 5 ; 0 -5; 0 5"
            repeatCount="indefinite" begin="0.5"></animateTransform>
        </rect>
      </g>
    </svg>
  </div>
  <script>
    var btn = document.querySelector('.btn-box > span');
    var svg = document.querySelector('.btn-box > svg');

    btn.onclick = function () {
      open()
      btn.className = 'animated flipOutY'
    }

    btn.addEventListener('animationend', function () {
      if (btn.className.includes('flipOutY')) {
        btn.style.display = 'none'
        svg.style.display = 'block'
      }
    })

    function open() {
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function () {
        alertContents(xhr)
      };
      xhr.open('POST', 'https://www.91hilife.com/erp//front/interface/door/openDoor/three');
      xhr.send(JSON.stringify(data));
    }

    function alertContents(httpRequest) {
      if (httpRequest.readyState === XMLHttpRequest.DONE) {
        if (httpRequest.status === 200) {
          setTimeout(function () {
            btn.innerHTML = 'OK!';
            btn.style.display = 'block';
            svg.style.display = 'none'
            btn.className = 'animated flipInY'
          }, 3000)
        } else {
          alert('There was a problem with the request.');
        }
      }
    }

    var data = { "isScan": 2, "access_token": "a123a37b-4c71-4d1b-b6ae-0592eb519ab7", "userId": "1699535220254196450", "version": "6.1.0", "doorName": "麒麟社3号楼大堂", "doorCommunityId": "337", "doorId": 19209, "communityId": "337", "customID": "243222958701758167", "cardNo": "1103905574" }
  </script>
</body>

</html>